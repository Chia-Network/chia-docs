"use strict";(self.webpackChunkchia_docs=self.webpackChunkchia_docs||[]).push([[2868],{805:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>c,frontMatter:()=>n,metadata:()=>a,toc:()=>h});var i=o(5893),r=o(1151);const n={title:"Timelords",slug:"/timelord-architecture"},s=void 0,a={id:"architecture/timelords",title:"Timelords",description:'Timelords support the network by creating sequential proofs of time (using a Verifiable Delay Function) and broadcasting them approximately every nine seconds. This provides "deterministic randomness", which is used to decide the winning proofs of space.',source:"@site/docs/architecture/timelords.md",sourceDirName:"architecture",slug:"/timelord-architecture",permalink:"/zh/timelord-architecture",draft:!1,unlisted:!1,editUrl:"https://github.com/Chia-Network/chia-docs/blob/main/docs/architecture/timelords.md",tags:[],version:"current",frontMatter:{title:"Timelords",slug:"/timelord-architecture"},sidebar:"tutorialSidebar",previous:{title:"Harvesters",permalink:"/zh/harvester-architecture"},next:{title:"Pools",permalink:"/zh/pool-architecture"}},l={},h=[{value:"Types of Timelords",id:"types-of-timelords",level:2},{value:"Running a Timelord",id:"running-a-timelord",level:2},{value:"Installing a Timelord",id:"installing-a-timelord",level:2},{value:"Regular Timelords",id:"regular-timelords",level:3},{value:"Bluebox Timelords",id:"bluebox-timelords",level:3},{value:"The Future of Timelords",id:"the-future-of-timelords",level:2},{value:"Timelords and Attacks",id:"timelords-and-attacks",level:2},{value:"Terminology",id:"terminology",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(t.p,{children:["Timelords support the network by creating sequential proofs of time (using a ",(0,i.jsx)(t.a,{href:"/proof-of-time",children:"Verifiable Delay Function"}),') and broadcasting them approximately every nine seconds. This provides "deterministic randomness", which is used to decide the winning proofs of space.']}),"\n",(0,i.jsx)(t.p,{children:"Since this computation is sequential, very little energy is consumed, as opposed to proof-of-work systems, where computation is parallelizable. For example, if 100 timelords are doing the same computation on a proof of time, they will all create the exact same output."}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:["The timelord algorithm is explained in the ",(0,i.jsx)(t.a,{href:"/timelord-algorithm",children:"Timelord Algorithm page"}),"."]})}),"\n",(0,i.jsx)(t.p,{children:"A timelord is required to connect to exactly one full node, typically on the same machine. This connection is verified with a certificate. This 1:1 architecture has a large security benefit: it keeps the timelord sandboxed in its own private network. That way, the full node protocol is the only protocol that requires total security. If more than one full node could connect to the same timelord, it would add a potential attack vector to the network."}),"\n",(0,i.jsx)(t.p,{children:"Timelords do not directly earn rewards. Furthermore, only the fastest timelord on the network will broadcast proofs at any given time. Therefore, only one timelord is required to keep the network running, and most farmers will not feel compelled to run one. However, farmers with multi-PiB farms may want to run a timelord, both for redundancy and for protection against temporary local latency issues."}),"\n",(0,i.jsx)(t.p,{children:"If someone controls the fastest timelord in the world, it doesn't give them much of an advantage at winning rewards. However, they could potentially orphan or censor other farmers, depending on how much faster their timelord is."}),"\n",(0,i.jsx)(t.p,{children:"Furthermore, an attacker with a significantly faster timelord than anyone else could potentially run a long-range attack against the network with less than 42.7% of the total netspace. For security purposes, it is very important to maintain open designs of VDF hardware."}),"\n",(0,i.jsx)(t.admonition,{type:"info",children:(0,i.jsxs)(t.p,{children:["You can learn about potential attacks against Chia's network in the ",(0,i.jsx)(t.a,{href:"/consensus-attacks",children:"Attacks and Countermeasures page"}),"."]})}),"\n",(0,i.jsx)(t.h2,{id:"types-of-timelords",children:"Types of Timelords"}),"\n",(0,i.jsx)(t.p,{children:"There are two primary types of Timelords: Regular and Blueboxes."}),"\n",(0,i.jsxs)(t.p,{children:["The first is the core Timelord that takes in Proofs of Space and uses a single fastest core to perform repeated squaring in a ",(0,i.jsx)(t.a,{href:"https://github.com/Chia-Network/vdf-competition/blob/master/classgroups.pdf",children:"class group of unknown order"})," as fast as possible. Beside each running VDF (referred to as a vdf_client in the application and source) is a set of proof generation threads that accumulate the proof that the time calculation's number of iterations was done correctly."]}),"\n",(0,i.jsx)(t.p,{children:"The second are Bluebox Timelords. Blueboxes are most any machine - especially things like old servers or gaming machines - that scour the historical chain looking for uncompressed proofs of time. So that the chain moves quickly, the regular Timelords use a faster method of generating proofs of time but the proofs are larger, which takes your Raspberry Pi a lot more time and effort to validate and sync the blockchain. A Bluebox picks up an uncompressed Proof of Time and recreates it, but this time with the slower and more compact proofs generated at the end. Those are then gossiped around to everyone so they can replace the large and slow to verify Proofs of Time with the compact and much quicker to validate version of exactly the same thing."}),"\n",(0,i.jsx)(t.h2,{id:"running-a-timelord",children:"Running a Timelord"}),"\n",(0,i.jsx)(t.p,{children:"The network only requires one running Timelord to keep moving (liveness.) The way Timelords race is like they are on a series of 100 meter dashes. Each one takes off with the last good Proof of Space and tries to get to the total number of iterations required to complete a given Proof of Space. Better Proofs of Space require less iterations to prove. When the fastest Timelord announces the Proof of Time for this Proof of Space all of the other Timelords stop racing and are magically teleported to the starting line of the next 100 meter dash to start it all over again."}),"\n",(0,i.jsx)(t.p,{children:"It's good to have a few Timelords out there. There can be things like routing flaps or the overzealous backhoe that takes large swaths of the internet offline. If the fastest Timelord was just about to win the current dash when its internet blinked off in a fury of construction misadventure, then the second fastest will win that dash and the next dashes - until the fastest returns. One of the key qualities about Proofs of Time is that given the same Proof of Space, their output and proof are always the same (though the proofs can be larger or smaller and harder or easier to validate - they all end up with the same outcome.)"}),"\n",(0,i.jsx)(t.p,{children:"The Company plans to run a few Timelords around the world - and some backups too - to ensure that all Farmers and nodes can hear the beat that the Timelords are calling."}),"\n",(0,i.jsx)(t.h2,{id:"installing-a-timelord",children:"Installing a Timelord"}),"\n",(0,i.jsxs)(t.admonition,{type:"info",children:[(0,i.jsxs)(t.p,{children:["If you want to run a Timelord on Linux/MacOS, first follow the Install from Source instructions ",(0,i.jsx)(t.a,{href:"/installation#from-source",children:"here"}),". Then run:"]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-bash",children:". ./activate\nsh install-timelord.sh\nchia start timelord &\n"})})]}),"\n",(0,i.jsx)(t.p,{children:"Timelords execute sequential verifiable delay functions (proofs of time or VDFs), that get added to blocks to make them valid. This requires fast CPUs and a few cores per VDF."}),"\n",(0,i.jsxs)(t.p,{children:["Due to restrictions on how\xa0",(0,i.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Microsoft_Visual_C%2B%2B",children:"MSVC"}),"\xa0handles 128 bit numbers and how Python relies upon MSVC, it is not possible to build and run Timelords of all types on Windows."]}),"\n",(0,i.jsx)(t.h3,{id:"regular-timelords",children:"Regular Timelords"}),"\n",(0,i.jsxs)(t.p,{children:["On MacOS x86_64 and all Linux distributions, building a Timelord is as easy as running\xa0",(0,i.jsx)(t.code,{children:"chia start timelord &"}),"\xa0in the virtual environment. You can also run\xa0",(0,i.jsx)(t.code,{children:"./vdf_bench square_asm 400000"}),"\xa0once you've built Timelord to give you a sense of your optimal and unloaded ips. Each run of\xa0",(0,i.jsx)(t.code,{children:"vdf_bench"}),'\xa0can be surprisingly variable and, in production, the actual ips you will obtain will usually be about 20% lower due to load of creating proofs. The default configuration for Timelords is good enough to just let you start it up. Set your log level to INFO and then grep for "Estimated IPS:" to get a sense of what actual ips your Timelord is achieving.']}),"\n",(0,i.jsx)(t.h3,{id:"bluebox-timelords",children:"Bluebox Timelords"}),"\n",(0,i.jsxs)(t.p,{children:["Once you build the Timelord with\xa0",(0,i.jsx)(t.code,{children:"sh install-timelord.sh"}),"\xa0in the virtual environment, you will need to make two changes to\xa0",(0,i.jsx)(t.code,{children:"~/.chia/VERSION/config.yaml"}),". In the\xa0",(0,i.jsx)(t.code,{children:"timelord:"}),"\xa0section, set\xa0",(0,i.jsx)(t.code,{children:"bluebox_mode:"}),"\xa0to\xa0",(0,i.jsx)(t.code,{children:"True"}),". Then you need to proceed to the\xa0",(0,i.jsx)(t.code,{children:"full_node:"}),"\xa0section and set\xa0",(0,i.jsx)(t.code,{children:"send_uncompact_interval:"}),"\xa0to something greater than 0. We recommend\xa0",(0,i.jsx)(t.code,{children:"300"}),"\xa0seconds there so that your Bluebox has some time to prove through a lot of the un-compacted Proofs of Time before the node drops more into its lap. The default settings may otherwise work but if the total effort is a little too much for whatever machine you are on you can also lower the\xa0",(0,i.jsx)(t.code,{children:"process_count:"}),"\xa0from 3 to 2, or even 1, in the\xa0",(0,i.jsx)(t.code,{children:"timelord_launcher:"}),"\xa0section. You know it is working if you see\xa0",(0,i.jsx)(t.code,{children:"VDF Client: Sent proof"}),"\xa0in your logs at INFO level."]}),"\n",(0,i.jsx)(t.h2,{id:"the-future-of-timelords",children:"The Future of Timelords"}),"\n",(0,i.jsxs)(t.p,{children:["In 2023, CNI received its first batch of ASIC timelords. When run as a cluster of three VDFs, these timelords could hit upwards of one million IPS. This was approximately four times the speed of the fastest non-ASIC timelords. After installing several timelords in strategic locations globally, and after thorough testing on private testnets, the company added the ASICs to the biggest public testnet -- testnet10. Finally, after ",(0,i.jsx)(t.a,{href:"https://www.businesswire.com/news/home/20211013005324/en/Chia-Partners-With-Supranational-to-Create-Industry-Leading-Proof-of-Space-Time-Security",children:"years of designing"})," the ASICs and months of testing them, they were activated on mainnet in October 2023."]}),"\n",(0,i.jsxs)(t.p,{children:["The next step is to distribute some of the remaining ASIC timelords to a select list of applicants, as detailed in a ",(0,i.jsx)(t.a,{href:"https://www.chia.net/2023/10/26/asic-timelords-faster-than-fast-chia-network/",children:"blog post"}),". This process will ensure a high amount of global redundancy on this critical network infrastructure."]}),"\n",(0,i.jsx)(t.p,{children:"Of course, as technology improves, the ASIC design will need to be updated. However, this process is extremely costly, and the current generation is already pushing upon the limits imposed by the laws of physics. We expect the current crop to remain the fastest timelords in the world for years to come."}),"\n",(0,i.jsx)(t.h2,{id:"timelords-and-attacks",children:"Timelords and Attacks"}),"\n",(0,i.jsxs)(t.p,{children:["One of the things that is great about\xa0",(0,i.jsx)(t.a,{href:"/consensus-intro",children:"Chia's new consensus"}),"\xa0is that it makes it almost impossible for a Farmer with a maliciously faster Timelord to selfishly Farm. Due to the way the new consensus works, a Farmer with a faster Timelord is basically compelled to prove time for all the farmers winning blocks around him also. Maliciously running a faster Timelord can give a benefit when attempting to 51% attack the network, so it is still important that over time we push the Timelord speeds as close to the maximum speeds of the silicon processes available. We expect to have the time and the resources to do that right and make open-source hardware versions widely available."]}),"\n",(0,i.jsx)(t.h2,{id:"terminology",children:"Terminology"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:'VDF: verifiable delay function, another way to say "proof of time"'}),"\n",(0,i.jsx)(t.li,{children:'Timelord launcher: a small program which launches "vdf client" processes over and over, to perform the actual VDF calculations.'}),"\n",(0,i.jsx)(t.li,{children:"VDF client: a C++ process which performs a VDF computation and then shuts down"}),"\n",(0,i.jsx)(t.li,{children:"Timelord: The timelord communicates with the node, and is what decides which VDF tasks to assign to which clients. The vdf clients connect through HTTP to the timelord. So you can have the timelord in a separate machine as the timelord launcher"}),"\n"]})]})}function c(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},1151:(e,t,o)=>{o.d(t,{Z:()=>a,a:()=>s});var i=o(7294);const r={},n=i.createContext(r);function s(e){const t=i.useContext(n);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(n.Provider,{value:t},e.children)}}}]);