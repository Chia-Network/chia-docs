---
sidebar_position: 1
---

# 9.1 BLS Keys

This section will explain the different types of keys in the Chia network, how they are generated, stored, and used.
These systems are designed to be flexible enough to support many different configurations and pooling setups and to be resilient to various attacks.

All Chia keys are BLS-12-381 private keys, following the [IETF spec](https://datatracker.ietf.org/doc/draft-irtf-cfrg-bls-signature/), the [EIP-2333](https://eips.ethereum.org/EIPS/eip-2333) spec for key derivation and [BIP 44 registered](https://github.com/satoshilabs/slips/blob/master/slip-0044.md). Private keys are 32 bytes, public keys 48 bytes, and signatures 96 bytes (public keys are points in G1, signatures are points in G2.) BLS signatures allow for many features and optimizations like non-interactive m/n thresholds, aggregation of all signatures in a block, and [chialisp](https://chialisp.com) tricks like combining two coins into the same transaction.
Private keys can be generated by using a 24 word mnemonic phrase. Users can back up only these 24 words, and use these wherever they want. 
There is a slight difference between Chia's implementation and EIP-2333, it's described in the bottom of this page.
As you can see, the 24 words can be converted to and from a BLS private key. The BLS master private key is stored in the OS keychain, which usually requires password authentication and is encrypted. 

The master private key can be used to derive child keys, which can further be used to derive child keys, etc. The number of levels can be infinite.
BLS public keys can be combined to form a new public key, which can be used to validate aggregate signatures.


Each time the wallet generates a new address to receive funds, it creates a new bls private key.
The farmer and pool only use the first key in the current codebase, but they can be updated to generate a new key every time a block is won, for additional privacy.
pk stands for public key, and sk stands for private (secret) key.
When it comes to getting paid, a chialisp program is created that uses one of the wallet BLS public keys, and this program, called a puzzle, is hashed to generate a puzzle hash. 
The puzzle hash is then converted to an address in bech32m format, for easy error correction and usability. 
So an address is analogous to a wallet child BLS public key, the private key which can be derived from the master seed.

<figure>
<img src="/img/keys/hd_keys.png" alt="drawing"/>
</figure>

## Difference between Chia and EIP-2333
The specification followed in Chia is the one described in https://datatracker.ietf.org/doc/draft-irtf-cfrg-bls-signature/
in version 1. There was a change made in version 2 which makes the key generation incompatible. Both versions are secure,
but Chia keys were created in 2020 and thus the older version of the specification is used.


## Hardened vs Unhardened Keys

There are two ways in which child keys can be derived from parent keys: hardened and unhardened.

Hardened keys are the default and only supported method in the EIP-2333 spec. They are secure, since each key
is cryptographically separated, and revealing one key has no impact on the security of it's acenstors or siblings.
However, hardened keys are limited in functionality, because they can only be derived through private derivation. That
is, a parent private key can be used to derive a child private key, but you cannot do it in the public side: a parent
public key cannot be used to derive children public keys.

Unhardened keys do allow public derivation, which enables view only wallets that support viewing all of your keys,
using the root (master) public key. This is what is usually done for Bitcoin HD view only wallets. It enables more privacy
when compared to systems like Ethereum, which reuse the same address for all transactions. The main security drawback
of HD keys is that revealing one child private key along with the parent public key, the parent private key and all
sibling keys can be calculated as well.

The Chia wallet at launch only created hardened keys, but now unhardened keys are being used as well, and preferred, for
the view only wallet support.