---
sidebar_position: 3
---

# 9.3 绘制公钥

> Plot Public Keys

那么，上一节展示的剧情公钥是什么？从技术上讲，绘图公钥可以是任何 BLS 公钥，只要区块中包含正确的签名，全节点就会允许它。然而，BLS 允许我们将许多公钥组合成一个，从而允许本地 N/N 签名，而无需完整节点注意到使用了多重签名。在当前版本的 chia-blockchain 中，我们利用它来提高安全性。请注意，这些方案不是共识关键，因此一些农民可能会使用不同的策略来生成他们的公钥。

绘图公钥通常以两种方式之一生成，第一种用于 OG 绘图，第二种用于合并绘图。

<details>
<summary>原文参考</summary>

So, what is the plot public key shown in the previous section? The plot public key can technically be any BLS public key,
and as long as the correct signatures are included in the block, full nodes will allow it. However, BLS allows us to combine
many public keys into one which allows native N/N signatures without full nodes noticing that a multisignature is used.
In the current versions of chia-blockchain, we use this to our advantage to increase security. Please note that these
schemes are not consensus critical, and therefore some farmers might use different strategies for generating their
public keys.

The plot public key is usually generated in one of two ways, the first for OG Plots, and the second for pooled plots.

</details>

## OG Plots

地块公钥为2/2 BLS聚合公钥，由农民公钥与本地公钥结合生成。本地公钥是为每个地块创建的完全随机的密钥，并放入该地块中。它们不是任何 BLS 密钥的子项，因此在情节之间完全独立。农夫钥匙是农夫机器存储的钥匙。

<details>
<summary>原文参考</summary>

- ## OG Plots

The plot public key is a 2/2 BLS aggregate public key, which is generated by combining the farmer public key with the local public key.
The local public key is a totally random key that is created for each plot, and put into the plot. They are not children
of any BLS keys, and therefore totally independent between plots.
The farmer key is a key that the farmer machine stores.

</details>

## 汇集地块

对于为与 Plot NFT 池化协议一起使用而生成的图，使用额外的“taproot”密钥，使聚合密钥为 3/3。这第三个密钥可以从其他 2 个密钥的公共信息中推导出来，它确保攻击者不能创建两个新密钥 k1 和 k2，使它们加起来成为原始聚合密钥。主根私钥定义为：

```python
taproot_sk = BLSKeyGen(sha256(bytes(local_pk + farmer_pk) + bytes(local_pk) + bytes(farmer_pk)))
```

每个块都需要来自绘图密钥的签名。这意味着我们需要组合两个（或三个）签名：来自收割机生成的本地密钥、来自农民生成的农民 sk，以及可选的来自主根密钥的签名也是农民生产的。农民将所有签名组合起来生成地块签名，对于网络的其余部分，它看起来像一个正常的 1/1 BLS 签名。

<details>
<summary>原文参考</summary>

- ## Pooled Plots

For plots which are generated for use with the Plot NFT pooling protocol, an additional "taproot" secret key is used,
making the aggregate key a 3/3. This 3rd key can be derived from public information of the other 2 keys, and it ensures
that an attacker cannot create two new keys k1 and k2 such that they both add up to the original aggregate key.
The taproot private key is defined as: 

```python
taproot_sk = BLSKeyGen(sha256(bytes(local_pk + farmer_pk) + bytes(local_pk) + bytes(farmer_pk)))
```

Each block requires a signature from the plot key. What this means, is that we need to combine two (or three) signatures: from the local secret key, which is generated by the harvester,
from the farmer sk, which is generated by the farmer, and optionally from the taproot key which is also generated by the farmer.
The farmer combines all the signatures to generate the plot signature, which will look like a normal 1/1 BLS signature
to the rest of the network.

</details>

## 绘图格式

绘图格式取决于使用的是农场到公钥还是农场到合同地址。如果耕种到合同地址，则拼图哈希（地址）会直接编码到绘图中。否则，池公钥将直接编码到图中。请注意，这不是确切的绘图格式，此处省略了更多细节。

重要的是收割机仅将其本地密钥存储在地块中，但收割机不需要其他密钥。仅凭这把钥匙是不够的，因为它必须与农夫的钥匙结合使用。因此，妥协收割机不允许攻击重定向奖励。

<figure>

![](/img/keys/plot_format.png)

</figure>

<details>
<summary>原文参考</summary>

- ## Plot format

The plot format depends on whether farm to public key or farm to contract address is being used. If farming to a contract
address, the puzzle hash (address) is directly encoded into the plot. Otherwise, the pool public key is directly encoded into the plot.
Note that this is not the exact plot format, there are a few more details that are left out here.

The important thing is that the harvester is only storing their local key in the plot, but no other keys are required
from the harvester. This key alone is not enough to do anything, since it must be combined with the farmer's key. 
Therefore compromising the harvester does not allow an attack to redirect rewards.

<figure>

![](/img/keys/plot_format.png)

</figure>

</details>
