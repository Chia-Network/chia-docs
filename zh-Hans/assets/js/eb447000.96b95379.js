"use strict";(self.webpackChunkchia_docs=self.webpackChunkchia_docs||[]).push([[99],{4533:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>t,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"reference-client/install-and-setup/password-protected-keys","title":"Password Protected Keys","description":"Overview","source":"@site/i18n/zh-Hans/docusaurus-plugin-content-docs/current/reference-client/install-and-setup/password-protected-keys.md","sourceDirName":"reference-client/install-and-setup","slug":"/reference-client/install-and-setup/password-protected-keys","permalink":"/zh-Hans/reference-client/install-and-setup/password-protected-keys","draft":false,"unlisted":false,"editUrl":"https://github.com/Chia-Network/chia-docs/blob/main/docs/reference-client/install-and-setup/password-protected-keys.md","tags":[],"version":"current","frontMatter":{"title":"Password Protected Keys","slug":"/reference-client/install-and-setup/password-protected-keys"},"sidebar":"tutorialSidebar","previous":{"title":"Key Management","permalink":"/zh-Hans/reference-client/install-and-setup/key-management"},"next":{"title":"Headless Node","permalink":"/zh-Hans/reference-client/install-and-setup/headless-node"}}');var r=n(4848),a=n(8453);const t={title:"Password Protected Keys",slug:"/reference-client/install-and-setup/password-protected-keys"},o=void 0,l={},h=[{value:"Overview",id:"overview",level:2},{value:"Motivation",id:"motivation",level:2},{value:"New Keyring",id:"new-keyring",level:2},{value:"Migration",id:"migration",level:2},{value:"Command Line Reference",id:"command-line-reference",level:2},{value:"Setting/Updating/Removing Passphrases",id:"settingupdatingremoving-passphrases",level:3},{value:"Passphrase Hints",id:"passphrase-hints",level:3},{value:"Reading Passphrases From a File",id:"reading-passphrases-from-a-file",level:3},{value:"Additional Notes",id:"additional-notes",level:2}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(s.p,{children:"We are introducing a new feature that allows users to specify a passphrase to protect their Chia keys across all currently supported platforms. Along with passphrase protection, this feature also introduces a new keyring file for storing those keys. By implementing a common key storage format, moving Chia keys between installations is greatly simplified, eliminating the need to re-enter each key's 24-word mnemonic. Any keys stored in the new keyring will be encrypted using a key derived from the specified passphrase."}),"\n",(0,r.jsxs)(s.admonition,{type:"warning",children:[(0,r.jsxs)(s.p,{children:["Your passphrase protects only from local access of your Chia client. ",(0,r.jsx)(s.strong,{children:"You must still protect your 24 words."})]}),(0,r.jsxs)(s.p,{children:["Chia is unable to assist with the recovery of a forgotten passphrase. Be sure to ",(0,r.jsx)(s.strong,{children:"backup the 24-word mnemonic"})," for each of your keys. If you forget your passphrase, you will be able to recover by importing your keys from their 24-word mnemonic."]})]}),"\n",(0,r.jsx)(s.h2,{id:"motivation",children:"Motivation"}),"\n",(0,r.jsx)(s.p,{children:"Chia's supported platforms each provide different solutions for storing sensitive data, with varying levels of security and different user experiences per platform. In addition, these platform dependent solutions for storing sensitive data did not provide a mechanism for the user to passphrase-protect Chia keys outside of whatever protection the OS already provided."}),"\n",(0,r.jsx)(s.p,{children:"On Linux, the cryptfile keyring Python module has been used with a fixed key."}),"\n",(0,r.jsx)(s.p,{children:"On macOS, the Keychain is used to securely store each key, sometimes requiring one or more system prompts to authorize access to the key material."}),"\n",(0,r.jsx)(s.p,{children:"This resulted in a system where keys were considered to be secure on systems, but that level of security was subjective to individual use cases and OS configuration, and not suitable for everyone's needs. Our primary goals with this passphrase feature have been to grant more control to our users, uniformly secure Chia keys, and to simplify the task of moving keys from one installation to another."}),"\n",(0,r.jsx)(s.h2,{id:"new-keyring",children:"New Keyring"}),"\n",(0,r.jsxs)(s.p,{children:["The new keyring file is a YAML document named ",(0,r.jsx)(s.code,{children:"keyring.yaml"}),". Upon launch, Chia will automatically create an empty ",(0,r.jsx)(s.code,{children:"keyring.yaml"})," file residing at:"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"%HOMEDRIVE%%HOMEPATH%/.chia_keys/keyring.yaml"})," (Windows)"]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.code,{children:"~/.chia_keys/keyring.yaml"})," (macOS and Linux)"]}),"\n",(0,r.jsxs)(s.p,{children:["Note that in this release, any new keys created or imported will be stored in the new ",(0,r.jsx)(s.code,{children:"keyring.yaml"})," file and not in the previous location."]}),"\n",(0,r.jsxs)(s.p,{children:["Keys in this new keyring file are encrypted using ChaCha20-Poly1305 (",(0,r.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc7539.html#section-2.8",children:"RFC 7539, Section 2.8"}),") which provides encryption and authentication (AEAD). The encryption key is derived from the user's passphrase using PBKDF2 with SHA-256 (",(0,r.jsx)(s.a,{href:"https://datatracker.ietf.org/doc/html/rfc2898",children:"RFC 2898"}),")."]}),"\n",(0,r.jsx)(s.h2,{id:"migration",children:"Migration"}),"\n",(0,r.jsx)(s.admonition,{type:"danger",children:(0,r.jsxs)(s.p,{children:["We ",(0,r.jsx)(s.strong,{children:"STRONGLY"})," recommend that users create backups of their 24-word mnemonic before migrating their keys."]})}),"\n",(0,r.jsxs)(s.p,{children:["Existing users with keys will want to migrate their keys from the previous location to the new ",(0,r.jsx)(s.code,{children:"keyring.yaml"})," file, and optionally protect those keys with a passphrase. We recommend all users create a strong passphrase. On macOS and Windows, users will have the option to save their passphrase to the macOS Keychain or Windows Credential Manager respectively, allowing for Chia to run unattended (such as after a reboot due to a power failure)."]}),"\n",(0,r.jsx)(s.p,{children:"When launching the Chia GUI application, a migration prompt will automatically appear if existing keys are detected. The GUI migration process is nearly instantaneous and will not delete or modify those keys that were found. It's strongly encouraged that users perform the migration step right away to move to the new keyring. If necessary, it's possible to skip the migration step and continue using Chia as before, however, any attempts to add or delete a key will first require completion of the migration process."}),"\n",(0,r.jsx)(s.p,{children:"From the command line interface, keyring migration can be initiated by setting a passphrase for the new keyring, or by adding or deleting a key. When performing keyring migration from the command line, the user will have the option of deleting those old keys that were found and successfully migrated."}),"\n",(0,r.jsx)(s.admonition,{type:"note",children:(0,r.jsxs)(s.p,{children:["It is possible to migrate keys to the new key storage and not set a passphrase. In this case, the ",(0,r.jsx)(s.code,{children:"keyring.yaml"})," file will remain encrypted with a fixed key. When you remove a passphrase, that passphrase will also be removed from the macOS Keychain or Windows Credential Manager (if saved there by the user)."]})}),"\n",(0,r.jsx)(s.h2,{id:"command-line-reference",children:"Command Line Reference"}),"\n",(0,r.jsx)(s.h3,{id:"settingupdatingremoving-passphrases",children:"Setting/Updating/Removing Passphrases"}),"\n",(0,r.jsx)(s.p,{children:"Setting or updating a passphrase for keyring.yaml. This will prompt for keyring migration as necessary:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"chia passphrase set\n"})}),"\n",(0,r.jsx)(s.p,{children:"When setting a passphrase, an optional hint may be specified. This hint will be displayed by the GUI when prompting for your keyring passphrase:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'chia passphrase set --hint "Summer of 2020"\n'})}),"\n",(0,r.jsxs)(s.p,{children:["Removing a passphrase from ",(0,r.jsx)(s.code,{children:"keyring.yaml"}),". Note, keyring.yaml always keeps keys stored in an encrypted form. Without a user-specified passphrase, a fixed encryption is used:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"chia passphrase remove\n"})}),"\n",(0,r.jsx)(s.h3,{id:"passphrase-hints",children:"Passphrase Hints"}),"\n",(0,r.jsx)(s.p,{children:"A passphrase hint can be set to assist in remembering the keyring passphrase. The hint data is stored in keyring.yaml as cleartext (not encrypted)."}),"\n",(0,r.jsx)(s.p,{children:"Setting a passphrase hint when a passphrase is in use. This command will fail if a passphrase hasn't been previously set:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'chia passphrase hint set "Summer of 2020"\n'})}),"\n",(0,r.jsx)(s.p,{children:"Removing a passphrase hint. This command will fail if a passphrase and passphrase hint haven't been previously set:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"chia passphrase hint delete\n"})}),"\n",(0,r.jsx)(s.p,{children:"Displaying a passphrase hint. This command will fail if a passphrase and passphrase hint haven't been previously set:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"chia passphrase hint display\n"})}),"\n",(0,r.jsx)(s.h3,{id:"reading-passphrases-from-a-file",children:"Reading Passphrases From a File"}),"\n",(0,r.jsx)(s.p,{children:"Passphrases may be accessed from a file (or file descriptor on macOS/Linux) to assist with automated workflows. Note that whitespace is not stripped from the passphrase when read from a file."}),"\n",(0,r.jsx)(s.p,{children:"Reading the passphrase from a file:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'chia --passphrase-file "~/.my_chia_passphrase" keys show\n'})}),"\n",(0,r.jsx)(s.p,{children:"Reading the passphrase from another process (on macOS/Linux):"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"chia --passphrase-file <(echo -n 'my super secure passphrase') keys show\n"})}),"\n",(0,r.jsx)(s.h2,{id:"additional-notes",children:"Additional Notes"}),"\n",(0,r.jsx)(s.p,{children:"On macOS and Windows, an option is available to save the passphrase to the OS-provided secure credential store (macOS Keychain or Windows Credential Manager). This option may help with automated workflows, but carries a risk that other processes may be able to read the saved passphrase without requiring user authorization. For this reason, it's recommended that users only save their passphrase if they fully trust their environment."}),"\n",(0,r.jsx)(s.p,{children:"To facilitate downgrading to a prior version of Chia, keys will be left intact in their old locations after migration (unless migrating from the command line, and the option to delete old keys was selected)."}),"\n",(0,r.jsxs)(s.p,{children:["If necessary, it's possible to temporarily disable passphrase support as well as usage of the new keyring. To disable passphrase and keyring support, set the ",(0,r.jsx)(s.code,{children:"CHIA_PASSPHRASE_SUPPORT"})," environment variable to ",(0,r.jsx)(s.code,{children:"false"})," and run Chia as you normally would. Once disabled, Chia will use the old location for key retrieval and storage."]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"export CHIA_PASSPHRASE_SUPPORT=false; chia start farmer\n"})})]})}function c(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>t,x:()=>o});var i=n(6540);const r={},a=i.createContext(r);function t(e){const s=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(a.Provider,{value:s},e.children)}}}]);