<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-chia-blockchain/protocol/networking-protocol" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.1">
<title data-rh="true">Networking Protocol | Chia Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.chia.net/zh-Hans/img/chia-logo-yellow.png"><meta data-rh="true" name="twitter:image" content="https://docs.chia.net/zh-Hans/img/chia-logo-yellow.png"><meta data-rh="true" property="og:url" content="https://docs.chia.net/zh-Hans/chia-blockchain/protocol/networking-protocol/"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Networking Protocol | Chia Documentation"><meta data-rh="true" name="description" content="Shared networking protocol source"><meta data-rh="true" property="og:description" content="Shared networking protocol source"><link data-rh="true" rel="icon" href="/zh-Hans/svg/chia-leaf.svg"><link data-rh="true" rel="canonical" href="https://docs.chia.net/zh-Hans/chia-blockchain/protocol/networking-protocol/"><link data-rh="true" rel="alternate" href="https://docs.chia.net/chia-blockchain/protocol/networking-protocol/" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.chia.net/zh-Hans/chia-blockchain/protocol/networking-protocol/" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://docs.chia.net/chia-blockchain/protocol/networking-protocol/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Networking Protocol","item":"https://docs.chia.net/zh-Hans/chia-blockchain/protocol/networking-protocol"}]}</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/zh-Hans/assets/css/styles.f5e5d20e.css">
<script src="/zh-Hans/assets/js/runtime~main.f1f8c9d7.js" defer="defer"></script>
<script src="/zh-Hans/assets/js/main.6d249664.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/zh-Hans/svg/chia-leaf.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-Hans/"><div class="navbar__logo"><img src="/zh-Hans/svg/chia-leaf.svg" alt="Chia Icon" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/zh-Hans/svg/chia-leaf.svg" alt="Chia Icon" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Chia Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-Hans/chia-blockchain/introduction/">Docs</a><a class="navbar__item navbar__link" href="/zh-Hans/dev-guides-home/">Dev Guides</a><a class="navbar__item navbar__link" href="/zh-Hans/academy-home/">Chia Academy</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/chia-blockchain/protocol/networking-protocol/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/zh-Hans/chia-blockchain/protocol/networking-protocol/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li></ul></div><a href="https://chialisp.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chialisp<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://chia.net" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Chia Network<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/Chia-Network/chia-blockchain" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="搜索" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/zh-Hans/chia-blockchain/introduction/"><span title="Chia Blockchain" class="categoryLinkLabel_W154">Chia Blockchain</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/chia-blockchain/introduction/"><span title="Intro to Chia" class="linkLabel_WmDU">Intro to Chia</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/green-paper/green-paper-abstract/"><span title="Green Paper" class="categoryLinkLabel_W154">Green Paper</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/architecture/architecture-overview/"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/consensus/consensus-intro/"><span title="Consensus" class="categoryLinkLabel_W154">Consensus</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/coin-set-model/intro/"><span title="Coin Set Model" class="categoryLinkLabel_W154">Coin Set Model</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/keys/architecture/"><span title="Keys" class="categoryLinkLabel_W154">Keys</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/protocol/"><span title="Protocol" class="categoryLinkLabel_W154">Protocol</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/protocol/"><span title="Chia Protocol" class="linkLabel_WmDU">Chia Protocol</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/networking-protocol/"><span title="Networking Protocol" class="linkLabel_WmDU">Networking Protocol</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/serialization-protocol/"><span title="Serialization Protocol" class="linkLabel_WmDU">Serialization Protocol</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/harvester-protocol/"><span title="Harvester Protocol" class="linkLabel_WmDU">Harvester Protocol</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/peer-protocol/"><span title="Peer Protocol" class="linkLabel_WmDU">Peer Protocol</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/pool/pool-protocol/"><span title="Pool Protocol" class="categoryLinkLabel_W154">Pool Protocol</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-Hans/chia-blockchain/protocol/wallet-protocol/"><span title="Wallet Protocol" class="linkLabel_WmDU">Wallet Protocol</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/zh-Hans/chia-blockchain/resources/cryptocurrency-intro/"><span title="Resources" class="categoryLinkLabel_W154">Resources</span></a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/zh-Hans/cloud-wallet/getting-started/"><span title="Chia Cloud Wallet" class="categoryLinkLabel_W154">Chia Cloud Wallet</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/zh-Hans/chia-signer/getting-started/"><span title="Chia Signer App" class="categoryLinkLabel_W154">Chia Signer App</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/zh-Hans/reference-client/getting-started/farming-guide/"><span title="Chia Reference Client" class="categoryLinkLabel_W154">Chia Reference Client</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/zh-Hans/contribution/using-github/"><span title="Contributing" class="categoryLinkLabel_W154">Contributing</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/zh-Hans/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Chia Blockchain</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Protocol</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Networking Protocol</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>Networking Protocol</h1></header><p><a href="https://github.com/Chia-Network/chia-blockchain/blob/main/chia/protocols/shared_protocol.py" target="_blank" rel="noopener noreferrer">Shared networking protocol source</a></p>
<p>The Chia protocol is asynchronous and peer-to-peer. It runs on top of WebSockets on port 8444 (or other ports for farmers and timelords). All nodes act as both clients and servers, and can maintain long-term connections with other peers.</p>
<p>Every message in the Chia protocol is composed of bytes, using the Streamable format, and sent as a WebSocket message. Each message is composed of three parts:</p>
<ol>
<li>A field spanning 1 byte, representing the type of message being transmitted, and how to decode the data.</li>
<li>Second, an optional 2-byte ID, which is used per connection to keep track of requests and responses.</li>
<li>The data, which is a Streamable encoded representation of one of the protocol messages.</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token keyword" style="color:#990096">class</span><span class="token plain"> </span><span class="token class-name" style="color:#006100">Message</span><span class="token punctuation" style="color:#383a42">(</span><span class="token plain">Streamable</span><span class="token punctuation" style="color:#383a42">)</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token comment" style="color:#73737D;font-weight:normal"># one of ProtocolMessageTypes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token builtin" style="color:#127EAF">type</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint8</span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token comment" style="color:#73737D;font-weight:normal"># message id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token builtin" style="color:#127EAF">id</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> Optional</span><span class="token punctuation" style="color:#383a42">[</span><span class="token plain">uint16</span><span class="token punctuation" style="color:#383a42">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    </span><span class="token comment" style="color:#73737D;font-weight:normal"># Message data for that type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    data</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> </span><span class="token builtin" style="color:#127EAF">bytes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>Chia protocol messages have a max length of <code>(4 + 2^32 - 1) = 4294967299</code> bytes, or around 4 GB.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="handshake">Handshake<a href="#handshake" class="hash-link" aria-label="Handshake的直接链接" title="Handshake的直接链接" translate="no">​</a></h2>
<p>All peers in the Chia protocol (whether they are farmers, full nodes, timelords, etc.) act as both servers and clients (peers). As soon as a connection is initiated between two peers, both peers send a Handshake message, and a HandshakeAck message to complete the handshake. A peer&#x27;s node_id is the SHA-256 hash of their <a href="https://en.wikipedia.org/wiki/X.509" target="_blank" rel="noopener noreferrer">x.509</a> <a href="https://wiki.openssl.org/index.php/DER" target="_blank" rel="noopener noreferrer">DER</a> certificate.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#383a42;--prism-background-color:#fafafa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#383a42;background-color:#fafafa;font-weight:bold"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token keyword" style="color:#990096">class</span><span class="token plain"> </span><span class="token class-name" style="color:#006100">Handshake</span><span class="token punctuation" style="color:#383a42">(</span><span class="token plain">Streamable</span><span class="token punctuation" style="color:#383a42">)</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    network_id</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> </span><span class="token builtin" style="color:#127EAF">str</span><span class="token plain">                         </span><span class="token comment" style="color:#73737D;font-weight:normal"># Network id, ex. mainnet, testnet11, simulator0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    protocol_version</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> </span><span class="token builtin" style="color:#127EAF">str</span><span class="token plain">                   </span><span class="token comment" style="color:#73737D;font-weight:normal"># Protocol version to determine which messages the peer supports</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    software_version</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> </span><span class="token builtin" style="color:#127EAF">str</span><span class="token plain">                   </span><span class="token comment" style="color:#73737D;font-weight:normal"># Version of the software, to debug and determine feature support</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    server_port</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint16                     </span><span class="token comment" style="color:#73737D;font-weight:normal"># Which port the server is listening on</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    node_type</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> uint8                        </span><span class="token comment" style="color:#73737D;font-weight:normal"># NodeType (full node, wallet, farmer, etc.)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain">    capabilities</span><span class="token punctuation" style="color:#383a42">:</span><span class="token plain"> List</span><span class="token punctuation" style="color:#383a42">[</span><span class="token plain">Tuple</span><span class="token punctuation" style="color:#383a42">[</span><span class="token plain">uint16</span><span class="token punctuation" style="color:#383a42">,</span><span class="token plain"> </span><span class="token builtin" style="color:#127EAF">str</span><span class="token punctuation" style="color:#383a42">]</span><span class="token punctuation" style="color:#383a42">]</span><span class="token plain">  </span><span class="token comment" style="color:#73737D;font-weight:normal"># Key value dict to signal support for additional capabilities/features</span><span class="token plain"></span><br></span><span class="token-line" style="color:#383a42;font-weight:bold"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p>After the handshake is completed, both peers can send Chia protocol messages, and disconnect at any time by closing the WebSocket.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="heartbeat">Heartbeat<a href="#heartbeat" class="hash-link" aria-label="Heartbeat的直接链接" title="Heartbeat的直接链接" translate="no">​</a></h2>
<p>Heartbeat messages are sent periodically by the WebSocket libraries. Peers that are unresponsive will therefore be disconnected.</p>
<p>If a node does not receive any message from a peer for a certain period of time, even if heartbeats are being received, then the node will disconnect and remove the peer from the active peer list.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="introducer">Introducer<a href="#introducer" class="hash-link" aria-label="Introducer的直接链接" title="Introducer的直接链接" translate="no">​</a></h2>
<p>Please refer to the <a href="https://docs.chia.net/guides/seeder-user-guide/" target="_blank" rel="noopener noreferrer">chia seeder documentation</a> for more information on setting up you own chia seeder / introducer and how to have it included in the default chia config.yaml.</p>
<p>When a new node joins the network, it randomly connects to existing nodes on the network.</p>
<p>To facilitate this process, a number of introducer nodes will temporarily be run by Chia and other users, which will crawl the network and support one protocol message: get_peers_introducer. The introducer will then return a random subset of known recent peers that the calling node will attempt to connect to.</p>
<p>DNS introducers are also available at different names, which return random reliable peers to connect to.</p>
<p>For example: <code>dig dns-introducer.chia.net</code>.</p>
<p>More DNS introducers will be recruited in the future; check the <a href="https://github.com/Chia-Network/chia-blockchain" target="_blank" rel="noopener noreferrer">chia-blockchain repository</a> for updates. The introducer is only contacted at initial launch of the application, or if the peer database has no good peers.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rpc">RPC<a href="#rpc" class="hash-link" aria-label="RPC的直接链接" title="RPC的直接链接" translate="no">​</a></h2>
<p>Aside from the Chia protocols described in the next page, there is also a local RPC protocol to allow simple control over a node or wallet through HTTPS. All requests and responses for the RPC protocol are in JSON, to simplify the interface. This allows doing things like getting the tips of the chain, getting a specific block, adding connections, stopping the node, etc. The full node UI connects to the full node using the RPC.</p>
<p>The RPC APIs are provided in both WebSocket and HTTPS format.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="incoming-and-outgoing-connections">Incoming and Outgoing Connections<a href="#incoming-and-outgoing-connections" class="hash-link" aria-label="Incoming and Outgoing Connections的直接链接" title="Incoming and Outgoing Connections的直接链接" translate="no">​</a></h2>
<p>The Chia software has multiple rules and checks to make sure a node is connected to several good peers.</p>
<p>For example, outgoing connections (connections which our node makes to external nodes) are ranked higher than incoming ones. This is because we cannot verify whether incoming peers are part of an attack or not.</p>
<p>Each node will try to connect to 8 (implementation-dependent) external peers. As long as a node is connected to at least one fast and non-malicious peer, the node should be able to keep up with, and maintain, consensus with the heaviest blockchain.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="bans">Bans<a href="#bans" class="hash-link" aria-label="Bans的直接链接" title="Bans的直接链接" translate="no">​</a></h2>
<p>If a peer appears to be acting dishonestly, it can be disconnected and temporarily banned from reconnecting. Reasons for banning include (but are not limited to) exceeding the limits provided for each type of protocol message, sending invalid information, and making the node throw an exception when handling a message.</p>
<p>The duration of the ban depends on the severity of the issue. Care should be taken to not ban honest peers by accident. Different implementations might have larger or different rate limits as well.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="certificates">Certificates<a href="#certificates" class="hash-link" aria-label="Certificates的直接链接" title="Certificates的直接链接" translate="no">​</a></h2>
<p>All connections between nodes are encrypted and signed with X.509 signed certificates. Each node generates an X.509 certificate and signs it with the Chia CA (Valid To: January 21, 2031, Serial Number: 5c8a71239328650eb9fef85cec32bf779ca6a0c5) for node connections on port 8444. Node IDs are derived by hashing the public key of the certificate, so each node can have a consistent node ID to use for authentication. Each node will also generate and have its own private CA and self-sign certificates for local connections to services like farmer and harvester.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="peer-gossiping">Peer gossiping<a href="#peer-gossiping" class="hash-link" aria-label="Peer gossiping的直接链接" title="Peer gossiping的直接链接" translate="no">​</a></h2>
<p>Peers are broadcasted within the network with <code>request_peers</code> and <code>respond_peers</code> messages. The <code>respond_peers</code> message contains up to 1000 peers, each having its IP address, its port and an estimate of its last active timestamp.</p>
<p>Data received from <code>respond_peers</code> messages or from the introducers are stored in peer tables, similar to Bitcoin&#x27;s. The tables will be used to randomly select peers in order to establish the outgoing connections. If we&#x27;ve successfully connected with the peer at least once, it is stored in the &quot;tried&quot; table. Otherwise, it is stored in the &quot;new&quot; table. The tried table protects the node from attacks (i.e. eclipse attacks), as an attacker won&#x27;t be able to easily alter it (all peers initially go into the new table). Periodically, feeler connections are made in order to increase the number of entries in the tried table: we select a peer from the new table and if it&#x27;s reachable, we move it to the tried table and then we disconnect it. Additionally, peer tables are stored on disk (in the <code>peers.dat</code> file) every 15 to 30 minutes, and then loaded every time the node restarts.</p>
<p>Both new and tried tables optimize for the network groups of the entries to be as diverse as possible (/8 for ipv4 and /16 for ipv6). The rules of storing the bucket and the bucket position for a given peer depend on hashing the peer&#x27;s network group, peer&#x27;s port, sender&#x27;s network group (peer that sent the &quot;respond_peers&quot; message containing our current peer), and a secret 32 byte key. This way, an attacker won&#x27;t be able to predict the bucket and the bucket position where a peer will be stored, and only one entry will be stored within the similar network groups (as the bucket and the bucket position calculations will be identical for similar network group peers).</p>
<p>When a new inbound peer connects to us, we relay its address to one peer we&#x27;re connected to by sending a <code>respond_peers</code> message. Similarly, when we receive a <code>respond_peers</code> message containing only one peer, we relay its address to two peers we&#x27;re connected to. This ensures when a new peer connects to the network, its address will be eventually known by everyone else. The relay peers are chosen deterministically by our key, the current day and their IP and port, by choosing the smallest value after hashing those values (while being deterministic, they also change every day). Additionally, our node sends its address once every 24 hours to all the peers it is connected to, to point that we&#x27;re still online.</p>
<p>All the above update the timestamps of the peers. Additionally, we update the timestamp of our outbound connections, at most once every 20 minutes, after they send us a message.</p>
<p>Beside picking our outgoing connections, the peer tables are also used to respond to <code>request_peers</code> messages. We pick random peers from both new and the tried table, assuming their timestamp is not too old and we don&#x27;t have too many failed connections with them. Every time peer A connects to peer B, peer A will send peer B a <code>request_peers</code> message. The answer will be a <code>respond_peers</code> message that will help peer A bootstrap further.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/Chia-Network/chia-docs/blob/main/docs/chia-blockchain/protocol/networking-protocol.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-Hans/chia-blockchain/protocol/protocol/"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Chia Protocol</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-Hans/chia-blockchain/protocol/serialization-protocol/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Serialization Protocol</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#handshake" class="table-of-contents__link toc-highlight">Handshake</a></li><li><a href="#heartbeat" class="table-of-contents__link toc-highlight">Heartbeat</a></li><li><a href="#introducer" class="table-of-contents__link toc-highlight">Introducer</a></li><li><a href="#rpc" class="table-of-contents__link toc-highlight">RPC</a></li><li><a href="#incoming-and-outgoing-connections" class="table-of-contents__link toc-highlight">Incoming and Outgoing Connections</a></li><li><a href="#bans" class="table-of-contents__link toc-highlight">Bans</a></li><li><a href="#certificates" class="table-of-contents__link toc-highlight">Certificates</a></li><li><a href="#peer-gossiping" class="table-of-contents__link toc-highlight">Peer gossiping</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Approach</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chia.net/approach" target="_blank" rel="noopener noreferrer" class="footer__link-item">White Paper</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Technology</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chia.net/greenpaper" target="_blank" rel="noopener noreferrer" class="footer__link-item">Green Paper</a></li><li class="footer__item"><a href="https://docs.chia.net/consensus-intro" target="_blank" rel="noopener noreferrer" class="footer__link-item">Consensus 1.1</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Developers</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chialisp.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chialisp</a></li><li class="footer__item"><a href="https://docs.chia.net/academy-home/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Chia Academy</a></li><li class="footer__item"><a href="https://docs.chia.net/guides/crash-course/introduction" target="_blank" rel="noopener noreferrer" class="footer__link-item">Developer Guides</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://chia.net/about" target="_blank" rel="noopener noreferrer" class="footer__link-item">About</a></li><li class="footer__item"><a href="https://chia.net/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://chia.net/contact" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">© 2025 Chia Network Inc., Licensed under the <a href="https://github.com/Chia-Network/chia-docs/blob/main/LICENSE" target="_blank">Apache License, Version 2.0</a> | <a href="https://chia.net/terms">Terms</a></div></div></div></footer></div>
</body>
</html>